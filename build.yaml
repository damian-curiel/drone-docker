#YAML simple de construcci√≥n


kind: pipeline
type: docker
name: Prueba para clip
steps:
- name: maven build with dind
  image: quay.io/testcontainers/dind-drone-plugin
  commands:
  - sleep 7
  - docker ps -a
  environment:
    CI_WORKSPACE: "/drone/src"
  settings:
    build_image: maven:3-jdk-10
    cmd: sleep 15 && mvn -B -DskipTests clean package && mvn test
  volumes:
  - name: dockersock
    path: /var/run

#Dockerfile y app se toma de app basada en go
- name: Push a Docker Registry
  image: plugins/docker
  settings:
    repo: fcuriel/drone
    auto_tag: true
    username: fcuriel
    password:
      from_secret: docker_pwd_damian
      
services:
- name: docker
  image: docker:dind
  privileged: true
  volumes:
  - name: dockersock
    path: /var/run

volumes:
- name: dockersock
  temp: {}
